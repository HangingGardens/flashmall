import{_ as N,d as z,y as w,o as c,c as S,a,z as _,t as i,m as V,e as $,A as f,E as L,a0 as I,p as K,f as O,v as Q,u as W,w as X,x as Y,h as p,k as D,F as G,b as U}from"./index-7d3f2326.js";import{B as Z}from"./BackIcon-029df9cf.js";import{_ as ee}from"./MCOIN-c941fc3b.js";import{a as te}from"./mall-20095dc9.js";import{q,a as se}from"./goods-dabc7393.js";const ae=""+new URL("../images/goodsmask-e0eac318.png",import.meta.url).href;const T=e=>(K("data-v-024ecdcc"),e=e(),O(),e),oe={class:"rounded-xl bg-white mt-3 text-sm text-default overflow-hidden relative"},ne=T(()=>a("img",{src:ae,class:"absolute right-0 top-0 w-[140px]"},null,-1)),le={class:"flex gap-2 px-4 py-3 relative"},ie={class:"flex-1 flex flex-col"},de={class:"flex-center-bw flex-1"},re={class:"font-semibold"},ue={class:"text-xs opacity-60 mt-1"},ce={class:"flex items-center"},pe=T(()=>a("img",{src:ee,class:"w-4 h-4 mr-1.5"},null,-1)),ge={class:"flex items-baseline"},ve={class:"text-lg font-semibold mr-1"},fe=T(()=>a("div",{class:"text-xs"},"Mcoin",-1)),me={class:"flex justify-end gap-3 text-xs px-4 py-2 bg-color2 relative"},he=z({props:{goods:{type:null,required:!0},index:{type:Number,required:!0}},emits:["handleTo","handleDown","handleUp","handleDel"],setup(e,{emit:o}){return(g,l)=>{const n=w("VanImage"),v=w("VanButton");return c(),S("div",oe,[ne,a("div",le,[_(n,{src:e.goods.icons&&e.goods.icons.split(",")[0],class:"w-[60px] h-[60px] rounded-md overflow-hidden",alt:""},null,8,["src"]),a("div",ie,[a("div",de,[a("div",re,i(e.goods.goodsName),1),a("div",ue,i(g.$t("shop.sellAmount"))+" "+i(e.goods.salesVolume||0),1)]),a("div",ce,[pe,a("div",ge,[a("div",ve,i(e.goods.price),1),fe])])])]),a("div",me,[V(` <VanButton round hairline type="primary" class="border border-solid border-default text-default h-[24px] px-5"
        :loading="goods.loading" v-if="goods.status">
        {{ $t('shop.editPrice') }}
      </VanButton> `),e.goods.status&&e.goods.status===1?(c(),$(v,{key:0,round:"",hairline:"",type:"primary",class:"border border-solid border-default text-default h-[24px] px-5",loading:e.goods.loading,onClick:l[0]||(l[0]=I(()=>o("handleDown",e.goods,e.index),["stop"]))},{default:f(()=>[L(i(g.$t("shop.down")),1)]),_:1},8,["loading"])):V("v-if",!0),e.goods.status&&e.goods.status===2?(c(),$(v,{key:1,round:"",hairline:"",type:"primary",class:"border border-solid border-default text-default h-[24px] px-5",loading:e.goods.loading,onClick:l[1]||(l[1]=I(()=>o("handleUp",e.goods,e.index),["stop"]))},{default:f(()=>[L(i(g.$t("shop.up")),1)]),_:1},8,["loading"])):V("v-if",!0),e.goods.status?V("v-if",!0):(c(),$(v,{key:2,round:"",hairline:"",type:"primary",class:"border border-solid border-default text-default h-[24px] px-5",loading:e.goods.loading,onClick:l[2]||(l[2]=I(()=>o("handleDel",e.goods,e.index),["stop"]))},{default:f(()=>[L(i(g.$t("shop.delete")),1)]),_:1},8,["loading"])),_(v,{round:"",hairline:"",class:"btn text-white bg-primary h-[24px] px-5",loading:e.goods.loading,onClick:l[3]||(l[3]=()=>o("handleTo",`/editgoods?id=${e.goods.id}`))},{default:f(()=>[L(i(g.$t("shop.modify")),1)]),_:1},8,["loading"])])])}}}),xe=N(he,[["__scopeId","data-v-024ecdcc"],["__file","/Users/wangkeai/work/xueyan/flashmall/flashmall-dapp/src/view/shop/components/SellingGoodsItem.vue"]]);const be={class:"text-default text-sm pb-20 bg-gray1"},ye={class:"flex-start gap-2 px-3 py-2 sticky top-0 z-50 bg-white"},we={class:"px-3"},_e=z({setup(e){const{t:o}=Q(),{accountStore:g}=W(),l=X(),n=Y({active:0,tabList:[{id:1,name:`${o("shop.selling")}(0)`},{id:2,name:o("shop.watiShelf")},{id:0,name:o("shop.manuscript")}]}),v=t=>{l.push(t)},d=p([]),h=p(!1),x=p(!1),b=p(0),H=p(10),C=p(0),r=p(0),R=async()=>{x.value=!1,b.value=0,C.value=0,B()},B=async()=>{h.value=!0,b.value+=1,await M(),h.value=!1},M=async()=>{const t=await te({merchant:g.account,status:n.tabList[n.active].id,page:b.value,size:H.value});if(h.value=!1,!t.success){x.value=!0;return}if(!t.data||!t.total){x.value=!0,d.value=b.value===1?[]:d.value;return}C.value=t.total,r.value=n.active?r.value:t.total,n.tabList[0].name=`${o("shop.selling")}(${r.value})`;const s=p([]);s.value=t.data.map((u,m)=>({btnLoading:!1,...u.goods})),d.value=b.value===1?s.value:d.value.concat(s.value),d.value.length>=C.value&&(x.value=!0)},A=()=>{R()},E=async(t,s)=>{t.loading=!0;const u={id:t.id,status:2},m=await q(u);t.loading=!1,m.success&&(d.value.splice(s,1),r.value=r.value-1,n.tabList[0].name=`${o("shop.selling")}(${r.value})`)},F=async(t,s)=>{t.loading=!0;const u={id:t.id,status:1},m=await q(u);t.loading=!1,m.success&&(d.value.splice(s,1),r.value=r.value+1,n.tabList[0].name=`${o("shop.selling")}(${r.value})`)},j=async(t,s)=>{t.loading=!0;const u=await se(t.id);t.loading=!1,u.success&&d.value.splice(s,1)};return(t,s)=>{const u=w("VanList"),m=w("VanTab"),P=w("VanTabs");return c(),S("div",be,[a("div",ye,[_(Z),a("div",null,i(t.$t("shop.sellingGoods")),1)]),a("div",we,[_(P,{active:D(n).active,"onUpdate:active":s[2]||(s[2]=k=>D(n).active=k),onChange:A},{default:f(()=>[(c(!0),S(G,null,U(D(n).tabList,k=>(c(),$(m,{title:k.name,key:k.id,class:"relative"},{default:f(()=>[_(u,{loading:h.value,"onUpdate:loading":s[0]||(s[0]=y=>h.value=y),finished:x.value,"finished-text":t.$t("common.noMore"),"loading-text":t.$t("common.loading"),onLoad:B},{default:f(()=>[(c(!0),S(G,null,U(d.value,(y,J)=>(c(),$(xe,{key:y.id,index:J,goods:y,onHandleDown:E,onHandleUp:F,onHandleDel:j,onHandleTo:v},null,8,["index","goods"]))),128))]),_:1},8,["loading","finished","finished-text","loading-text"]),a("button",{class:"btn-orange w-[180px] h-10 flex-center text-white font-semibold fixed x-center bottom-9 z-50",onClick:s[1]||(s[1]=y=>v("/editgoods"))},i(t.$t("shop.releaseGoods")),1)]),_:2},1032,["title"]))),128))]),_:1},8,["active"])])])}}}),Ce=N(_e,[["__scopeId","data-v-27246be8"],["__file","/Users/wangkeai/work/xueyan/flashmall/flashmall-dapp/src/view/shop/ShopGoods.vue"]]);export{Ce as default};
