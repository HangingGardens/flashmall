import{_ as B,d as G,h as i,y as c,o as k,e as T,A as u,a as s,t as h,z as l,E as D,p as Y,f as J,v as de,V as ue,w as ie,u as re,Y as j,D as pe,W as A,i as ce,c as ve,k as $,m as F,a3 as M,G as O}from"./index-27cd35bf.js";import{B as me}from"./BackIcon-9938d35a.js";import{_ as K}from"./goodsTipsBg-e3ddc51b.js";import{u as W}from"./upload-ca083a08.js";import{c as fe,b as ge}from"./goods-602bd070.js";import{q as _e}from"./category-e90f289c.js";const he=p=>(Y("data-v-373c089e"),p=p(),J(),p),we={class:"w-full min-h-[150px] text-center rounded-xl p-3.5 bg-origin3 relative"},ye=he(()=>s("img",{src:K,class:"absolute top-0 left-0 w-full h-full"},null,-1)),xe={class:"mb-2.5"},be=G({props:{name:{type:null,required:!1}},emits:["close","handleLeave","handleDraft"],setup(p,{emit:r}){const v=i(!0);return(w,d)=>{const y=c("VanButton"),x=c("VanPopup");return k(),T(x,{show:v.value,"onUpdate:show":d[2]||(d[2]=b=>v.value=b),style:{background:"transparent",width:"98%","min-width":"280px","max-width":"350px"},"close-on-click-overlay":!0,onClickOverlay:d[3]||(d[3]=()=>r("close"))},{default:u(()=>[s("div",we,[ye,s("div",xe,h(w.$t("goods.isSaveDraft")),1),l(y,{class:"min-w-[165px] h-[40px] px-[50px] btn-orange btn-shadow text-white rounded-full",onClick:d[0]||(d[0]=()=>r("handleDraft"))},{default:u(()=>[D(h(w.$t("goods.saveDraft")),1)]),_:1}),l(y,{class:"min-w-[165px] h-[40px] px-[50px] bg-white text-primary rounded-full mt-2.5",onClick:d[1]||(d[1]=()=>r("handleLeave"))},{default:u(()=>[D(h(w.$t("goods.notSave")),1)]),_:1})])]),_:1},8,["show"])}}}),Ve=B(be,[["__scopeId","data-v-373c089e"],["__file","/Users/wangkeai/work/xueyan/flashmall/flashmall-dapp/src/view/goods/components/LeaveTipsPop.vue"]]),$e=""+new URL("../images/0-1564f380.svg",import.meta.url).href;const Q=p=>(Y("data-v-fdcc294a"),p=p(),J(),p),ke={class:"w-full min-h-[150px] rounded-xl p-3.5 bg-origin3 relative flex flex-col justify-center text-center"},De=Q(()=>s("img",{src:K,class:"absolute top-0 left-0 w-full h-full"},null,-1)),Ie=Q(()=>s("div",null,[s("img",{src:$e,class:"h-[40px] w-auto mx-auto"})],-1)),Le={class:"mt-2.5"},Ue=G({props:{text:{type:null,required:!1}},emits:["close","handleLeave","handleDraft"],setup(p,{emit:r}){const v=i(!0);return(w,d)=>{const y=c("VanPopup");return k(),T(y,{show:v.value,"onUpdate:show":d[0]||(d[0]=x=>v.value=x),style:{background:"transparent",width:"98%","min-width":"280px","max-width":"350px"},"close-on-click-overlay":!0,onClickOverlay:d[1]||(d[1]=()=>r("close"))},{default:u(()=>[s("div",ke,[De,Ie,s("div",Le,h(p.text),1)])]),_:1},8,["show"])}}}),Te=B(Ue,[["__scopeId","data-v-fdcc294a"],["__file","/Users/wangkeai/work/xueyan/flashmall/flashmall-dapp/src/view/goods/components/EmptyTipsPop.vue"]]);const Ee={class:"w-full h-ful p-2.5"},Pe={class:"text-xl font-semibold mt-2.5"},Ce={class:"bg-white rounded-xl overflow-hidden mt-2.5 p-2"},Se={class:"w-[50px] h-[50px] border border-dashed rounded-xl border-[#D9D9D9] text-center text-lg text-[#d9d9d9] font-bold"},Re={class:"bg-white rounded-xl overflow-hidden mt-2.5"},Be={class:"bg-white rounded-xl overflow-hidden mt-2.5"},Ge={class:"bg-white rounded-xl overflow-hidden mt-2.5"},qe={class:"bg-white rounded-xl overflow-hidden mt-2.5"},Ne=D("%"),He={class:"bg-white rounded-xl overflow-hidden mt-2.5"},ze={class:"bg-white rounded-xl overflow-hidden mt-2.5"},je={class:"bg-white rounded-xl overflow-hidden mt-2.5"},Ae={class:"p-2 pt-0"},Fe={class:"w-[50px] h-[50px] border border-dashed rounded-xl border-gray2 bg-gray1 text-center text-lg text-gray2 font-bold"},Me={class:"flex items-center justify-evenly mt-3"},Oe=G({setup(p){const{t:r}=de(),v=ue(),w=ie();re();const[d,y]=j(!1),[x,b]=j(!1),t=i({id:null,icons:"",goodsName:"",isHot:0,price:null,discountRatio:null,subclassId:null,goodsDesc:null,goodsPic:"",deliveryType:1,status:1}),m=i([]),f=i([]),I=i(0),X=i([{value:0,text:r("common.no")},{value:1,text:r("common.yes")}]),g=i(1),Z=i([{value:1,text:r("common.send")},{value:2,text:r("common.offline")}]),V=i(0),ee=pe(()=>{let o=C.value.filter(e=>e.type===g.value);return o=o.map(e=>({value:e.id,text:e.name})),o});A(g,(o,e)=>{let n=C.value.filter(U=>U.type===g.value);V.value=n.length&&n[0].id}),A(x,(o,e)=>{o&&setTimeout(()=>{b(!1)},3e3)});const oe=async o=>{const e=M(o,"goodsImg"),n=await W(e);if(!n.success)return m.value.length-=1;m.value[m.value.length-1]={url:O.imgUrl+n.data}},te=async o=>{const e=M(o,"goodsDesc"),n=await W(e);if(!n.success)return f.value.length-=1;f.value[f.value.length-1]={url:O.imgUrl+n.data}},E=i(!1),L=i(!1),q=async()=>{E.value=!1,t.value.status=0,N(),H()},P=i(null),le=async()=>{if(!m.value.length)return P.value=r("goods.emptyImg"),b(!0);if(!t.value.goodsName||!t.value.price)return P.value=r("goods.notEmpty"),b(!0);L.value=!0,E.value=!1,t.value.status=1,H(),N()},N=()=>{const o=m.value.map(n=>n.url),e=f.value.map(n=>n.url);t.value.icons=o.join(","),t.value.goodsPic=e.join(","),t.value.isHot=I.value,t.value.deliveryType=g.value,t.value.subclassId=V.value},H=async()=>{const o=await fe(t.value);L.value=!1,o.success&&w.back()},se=()=>{E.value=!1},C=i([]),ae=async()=>{const o=await _e();if(!o.success)return;C.value=o.data||[];const e=v.query.id;V.value=!e&&o.data&&+o.data[0].id},ne=async()=>{const o=v.query.id;if(!o)return;const e=await ge(+o);!e.success||(t.value=e.data.goods,t.value.icons&&(m.value=(t.value.icons||"").split(",").map(n=>({url:n}))),t.value.goodsPic&&(f.value=t.value.goodsPic.split(",").map(n=>({url:n}))),I.value=t.value.isHot,g.value=t.value.deliveryType,V.value=t.value.subclassId)};return ce(()=>{ae(),ne()}),(o,e)=>{const n=c("van-button"),U=c("van-uploader"),_=c("van-field"),S=c("van-dropdown-item"),R=c("van-dropdown-menu"),z=c("VanButton");return k(),ve("div",Ee,[s("header",null,[l(me),s("div",Pe,h(o.$t("goods.releaseGoods")),1)]),s("div",Ce,[l(U,{modelValue:m.value,"onUpdate:modelValue":e[0]||(e[0]=a=>m.value=a),accept:"image/*","max-count":5,"preview-size":"50",afterRead:oe},{default:u(()=>[s("div",Se,[l(n,{icon:"plus"})])]),_:1},8,["modelValue"])]),s("div",Re,[l(_,{modelValue:t.value.goodsName,"onUpdate:modelValue":e[1]||(e[1]=a=>t.value.goodsName=a),rows:"3",autosize:"",type:"textarea",placeholder:`*${o.$t("goods.goodsName")}`},null,8,["modelValue","placeholder"])]),s("div",Be,[l(_,{"input-align":"right",autocomplete:"off",label:`*${o.$t("goods.isHot")}`},{input:u(()=>[l(R,{"active-color":"#FEA021"},{default:u(()=>[l(S,{modelValue:I.value,"onUpdate:modelValue":e[2]||(e[2]=a=>I.value=a),options:X.value},null,8,["modelValue","options"])]),_:1})]),_:1},8,["label"])]),s("div",Ge,[l(_,{"input-align":"right",modelValue:t.value.price,"onUpdate:modelValue":e[3]||(e[3]=a=>t.value.price=a),label:`*${o.$t("goods.price")}`},null,8,["modelValue","label"])]),s("div",qe,[l(_,{"input-align":"right",modelValue:t.value.discountRatio,"onUpdate:modelValue":e[4]||(e[4]=a=>t.value.discountRatio=a),type:"digit",label:`*${o.$t("goods.discountRatio")}`},{"right-icon":u(()=>[Ne]),_:1},8,["modelValue","label"])]),s("div",He,[l(_,{"input-align":"right",autocomplete:"off",label:`*${o.$t("goods.deliveryType")}`},{input:u(()=>[l(R,{"active-color":"#FEA021"},{default:u(()=>[l(S,{modelValue:g.value,"onUpdate:modelValue":e[5]||(e[5]=a=>g.value=a),options:Z.value},null,8,["modelValue","options"])]),_:1})]),_:1},8,["label"])]),s("div",ze,[l(_,{"input-align":"right",autocomplete:"off",label:`*${o.$t("common.category")}`},{input:u(()=>[l(R,{"active-color":"#FEA021"},{default:u(()=>[l(S,{modelValue:V.value,"onUpdate:modelValue":e[6]||(e[6]=a=>V.value=a),options:$(ee)},null,8,["modelValue","options"])]),_:1})]),_:1},8,["label"])]),s("div",je,[l(_,{modelValue:t.value.goodsDesc,"onUpdate:modelValue":e[7]||(e[7]=a=>t.value.goodsDesc=a),rows:"3",autosize:"",type:"textarea",placeholder:`*${o.$t("goods.goodsDesc")}`},null,8,["modelValue","placeholder"]),s("div",Ae,[l(U,{modelValue:f.value,"onUpdate:modelValue":e[8]||(e[8]=a=>f.value=a),accept:"image/*","max-count":3,"preview-size":"50",afterRead:te},{default:u(()=>[s("div",Fe,[l(n,{icon:"plus"})])]),_:1},8,["modelValue"])])]),s("div",Me,[l(z,{type:"primary",class:"min-w-[130px] h-[40px] rounded-full border border-solid border-primary bg-none text-primary",onClick:e[9]||(e[9]=a=>q()),loading:L.value},{default:u(()=>[D(h(o.$t("goods.saveDraft")),1)]),_:1},8,["loading"]),l(z,{class:"min-w-[130px] h-[40px] rounded-full bg-gray2 text-white",onClick:e[10]||(e[10]=a=>le()),loading:L.value},{default:u(()=>[D(h(o.$t("goods.upimmediately")),1)]),_:1},8,["loading"])]),$(d)?(k(),T(Ve,{key:0,onClose:e[11]||(e[11]=a=>$(y)(!1)),onHandleLeave:se,onHandleDraft:q})):F("v-if",!0),$(x)?(k(),T(Te,{key:1,onClose:e[12]||(e[12]=a=>$(b)(!1)),text:P.value},null,8,["text"])):F("v-if",!0)])}}}),Ze=B(Oe,[["__scopeId","data-v-15e5717c"],["__file","/Users/wangkeai/work/xueyan/flashmall/flashmall-dapp/src/view/goods/EditGoods.vue"]]);export{Ze as default};
